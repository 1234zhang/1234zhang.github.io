---
layout: '[layout]'
title: Java内存模型(五)
date: 2019-08-05 17:43:58
categories:
    - Java
    - 《java并发编程艺术》读书笔记
tags:
    - Java并发编程
---
## 简介
锁的内存语义

<!-- more -->

## 锁的释放-获取建立的happens-before关系
锁是Java并发编程中最重要的同步机制。锁除了让临界区互斥执行之外，还可以让释放锁的线程向获取同一个锁的线程发送消息。
## 锁的释放和获取的内存语义
### 锁的释放
当线程释放锁时，JMM会把该线程对应的本地内存中的共享变量刷新到主内存中。
### 锁的获取
当线程获取锁时，JMM会把该线程对应的本地内存置为无效。从而使得被监视器保护的临界区代码必须从主内存中读取共享变量。
### 锁的内存语义
- 线程A释放一个锁，实质上是线程A向接下来将要获取这个锁的某个线程发出了（对共享变量做了修改）消息
- 线程B获取一个锁，实质上是线程B接收了之前某个线程发出的（在释放这个锁之前对共享变量所做修改的）消息
- 线程A释放锁，随后线程B获取这个锁，这个过程实质上是线程A通过主内存向线程B发送消息。
## 锁内存语义的实现
这个内容感觉有点重要，感觉自己并不能总结的很到位，我决定放一个传送门。找到文章的原链接，毕竟原博主比我强大多了。。。。。。。
[点击传送门](https://www.infoq.cn/article/java-memory-model-5)